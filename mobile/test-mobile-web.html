<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Egyptian Real Estate Mobile - Complete Test</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background-color: #f8fafc;
            direction: rtl; /* Right-to-left for Arabic */
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color: white;
            padding: 30px 20px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 24px;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }
        
        .header h1 {
            margin: 0;
            font-size: 28px;
            font-weight: 700;
        }
        
        .header p {
            margin: 8px 0 0 0;
            opacity: 0.9;
            font-size: 16px;
        }
        
        .test-section {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .test-section h2 {
            color: #1f2937;
            margin: 0 0 16px 0;
            font-size: 22px;
            font-weight: 600;
        }
        
        .test-status {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 16px;
        }
        
        .status-success {
            background: #dcfce7;
            color: #166534;
        }
        
        .status-loading {
            background: #fef3c7;
            color: #92400e;
        }
        
        .status-error {
            background: #fef2f2;
            color: #dc2626;
        }
        
        .loading {
            text-align: center;
            padding: 60px 20px;
            font-size: 18px;
            color: #6b7280;
        }
        
        .error {
            color: #dc2626;
            text-align: center;
            padding: 30px;
            background: #fef2f2;
            border-radius: 8px;
            border: 1px solid #fecaca;
        }
        
        .retry-btn {
            margin-top: 16px;
            padding: 12px 24px;
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .retry-btn:hover {
            background: #1d4ed8;
        }
        
        .property-card {
            background: #f9fafb;
            padding: 16px;
            margin-bottom: 12px;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }
        
        .property-title {
            font-size: 16px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 8px;
            text-align: right;
        }
        
        .property-price {
            font-size: 18px;
            font-weight: 700;
            color: #059669;
            margin-bottom: 8px;
            text-align: right;
        }
        
        .property-location {
            color: #6b7280;
            margin-bottom: 12px;
            font-size: 14px;
            text-align: right;
        }
        
        .property-details {
            display: flex;
            justify-content: space-around;
            margin-bottom: 12px;
            padding-top: 12px;
            border-top: 1px solid #e5e7eb;
            gap: 8px;
        }
        
        .property-details span {
            font-size: 13px;
            color: #374151;
            font-weight: 500;
        }
        
        .property-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .property-type {
            font-size: 11px;
            color: #6b7280;
            background: #f3f4f6;
            padding: 4px 8px;
            border-radius: 4px;
        }
        
        .property-status {
            font-size: 11px;
            color: #059669;
            font-weight: 600;
        }
        
        .virtual-tour-badge {
            font-size: 11px;
            color: #2563eb;
            font-weight: 600;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: #f8fafc;
            padding: 16px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e5e7eb;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: 700;
            color: #2563eb;
            margin-bottom: 4px;
        }
        
        .stat-label {
            font-size: 14px;
            color: #6b7280;
        }
        
        .test-info {
            margin-top: 24px;
            padding: 20px;
            background: linear-gradient(135deg, #e0f2fe, #b3e5fc);
            border-radius: 12px;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .test-info h3 {
            margin: 0 0 16px 0;
            color: #0369a1;
        }
        
        .test-info p {
            margin: 8px 0;
        }
        
        .test-info code {
            background: rgba(255, 255, 255, 0.7);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 12px;
            }
            
            .property-details {
                flex-direction: column;
                gap: 8px;
                text-align: center;
            }
            
            .property-meta {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .stats {
                grid-template-columns: 1fr 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="app">
            <div class="header">
                <h1>ğŸ  Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø­Ù…ÙˆÙ„ Ù„Ù„Ø¹Ù‚Ø§Ø±Ø§Øª Ø§Ù„Ù…ØµØ±ÙŠØ©</h1>
                <p>ØªØ¬Ø±Ø¨Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ù„Ù€ API ÙˆÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</p>
            </div>

            <!-- HomeScreen Test -->
            <div class="test-section">
                <h2>ğŸ“± Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (HomeScreen)</h2>
                <div id="home-status" class="test-status status-loading">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
                <div id="home-results"></div>
            </div>

            <!-- PropertiesScreen Test -->
            <div class="test-section">
                <h2>ğŸ¢ Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ø´Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª (PropertiesScreen)</h2>
                <div id="properties-status" class="test-status status-loading">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
                <div id="properties-results"></div>
            </div>

            <!-- Overall Stats -->
            <div class="test-section">
                <h2>ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</h2>
                <div class="stats">
                    <div class="stat-card">
                        <div id="total-properties" class="stat-number">0</div>
                        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª</div>
                    </div>
                    <div class="stat-card">
                        <div id="virtual-tours" class="stat-number">0</div>
                        <div class="stat-label">Ø¬ÙˆÙ„Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©</div>
                    </div>
                    <div class="stat-card">
                        <div id="avg-price" class="stat-number">0</div>
                        <div class="stat-label">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ø¹Ø± (Ø¬Ù†ÙŠÙ‡)</div>
                    </div>
                    <div class="stat-card">
                        <div id="api-calls" class="stat-number">0</div>
                        <div class="stat-label">Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª API</div>
                    </div>
                </div>
            </div>

            <div class="test-info">
                <h3>ğŸ§ª Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h3>
                <p><strong>Ø§Ù„Ù†Ø³Ø®Ø©:</strong> React Native 0.79.3 with TypeScript</p>
                <p><strong>API:</strong> <code>http://localhost:3000/api/properties</code></p>
                <p><strong>Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…Ø®ØªØ¨Ø±Ø©:</strong> HomeScreen, PropertiesScreen</p>
                <p><strong>Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª:</strong> Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§ØªØŒ Ø§Ù„Ø¨Ø­Ø«ØŒ Ø§Ù„ØªØµÙÙŠØ©ØŒ Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ù…ØµØ±ÙŠØ©ØŒ Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</p>
                <p><strong>Ø§Ù„Ù‡Ø¯Ù:</strong> Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù„Ù„Ù†Ø´Ø± Ø¹Ù„Ù‰ iOS/Android</p>
            </div>
        </div>
    </div>

    <script>
        let apiCalls = 0;
        let totalProperties = 0;
        let virtualToursCount = 0;
        let totalPrice = 0;

        function updateStatus(elementId, status, text) {
            const element = document.getElementById(elementId);
            element.className = `test-status status-${status}`;
            element.textContent = text;
        }

        function updateStats() {
            document.getElementById('total-properties').textContent = totalProperties;
            document.getElementById('virtual-tours').textContent = virtualToursCount;
            document.getElementById('avg-price').textContent = totalProperties ? 
                Math.round(totalPrice / totalProperties).toLocaleString('ar-EG') : '0';
            document.getElementById('api-calls').textContent = apiCalls;
        }

        function formatEGP(price) {
            return new Intl.NumberFormat('ar-EG', {
                style: 'currency',
                currency: 'EGP',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0,
            }).format(price);
        }

        function renderProperty(property, index) {
            const virtualTour = property.virtual_tour_url ? 
                `<div class="virtual-tour-badge">ğŸ  Ø¬ÙˆÙ„Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ©</div>` : '';
            
            return `
                <div class="property-card">
                    <div class="property-title">${property.title}</div>
                    <div class="property-price">${formatEGP(property.price)}</div>
                    <div class="property-location">ğŸ“ ${property.address}, ${property.city}</div>
                    <div class="property-details">
                        <span>ğŸ›ï¸ ${property.bedrooms} ØºØ±Ù</span>
                        <span>ğŸš¿ ${property.bathrooms} Ø­Ù…Ø§Ù…</span>
                        <span>ğŸ“ ${property.square_meters || 0}Ù…Â²</span>
                    </div>
                    <div class="property-meta">
                        <span class="property-type">${property.property_type}</span>
                        <span class="property-status">${property.status}</span>
                        ${virtualTour}
                    </div>
                </div>
            `;
        }

        // Test HomeScreen functionality
        async function testHomeScreen() {
            try {
                updateStatus('home-status', 'loading', 'â³ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©...');
                
                const response = await fetch('http://localhost:3000/api/properties?limit=5');
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const data = await response.json();
                apiCalls++;
                
                // API returns {properties: [...], pagination: {...}}
                if (data && data.properties && data.properties.length > 0) {
                    const featuredProperties = data.properties.slice(0, 3);
                    let html = `<h4>Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø© (${featuredProperties.length})</h4>`;
                    
                    featuredProperties.forEach((property, index) => {
                        html += renderProperty(property, index);
                        totalPrice += property.price;
                        if (property.virtual_tour_url) virtualToursCount++;
                    });
                    
                    totalProperties += featuredProperties.length;
                    
                    document.getElementById('home-results').innerHTML = html;
                    updateStatus('home-status', 'success', 
                        `âœ… Ù†Ø¬Ø­! ØªÙ… ØªØ­Ù…ÙŠÙ„ ${featuredProperties.length} Ø¹Ù‚Ø§Ø± Ù…Ù…ÙŠØ² Ù…Ù† ${data.properties.length} Ù…ØªØ§Ø­`);
                } else {
                    throw new Error('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù‚Ø§Ø±Ø§Øª ÙÙŠ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©');
                }
            } catch (error) {
                console.error('HomeScreen test failed:', error);
                document.getElementById('home-results').innerHTML = 
                    `<div class="error">âŒ ÙØ´Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: ${error.message}</div>`;
                updateStatus('home-status', 'error', `âŒ ÙØ´Ù„: ${error.message}`);
            }
            updateStats();
        }

        // Test PropertiesScreen functionality
        async function testPropertiesScreen() {
            try {
                updateStatus('properties-status', 'loading', 'â³ Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ø´Ø© Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª...');
                
                const response = await fetch('http://localhost:3000/api/properties?limit=10');
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const data = await response.json();
                apiCalls++;
                
                // API returns {properties: [...], pagination: {...}}
                if (data && data.properties && data.properties.length > 0) {
                    let html = `<h4>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª (${data.properties.length} Ù…Ù† ${data.pagination?.total || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'})</h4>`;
                    
                    data.properties.forEach((property, index) => {
                        html += renderProperty(property, index);
                        if (index < 5) { // Only count first 5 to avoid double counting with home
                            totalPrice += property.price;
                            if (property.virtual_tour_url) virtualToursCount++;
                        }
                    });
                    
                    totalProperties += Math.min(data.properties.length, 5);
                    
                    document.getElementById('properties-results').innerHTML = html;
                    updateStatus('properties-status', 'success', 
                        `âœ… Ù†Ø¬Ø­! ØªÙ… ØªØ­Ù…ÙŠÙ„ ${data.properties.length} Ø¹Ù‚Ø§Ø± Ù…Ø¹ ÙÙ„ØªØ±Ø© ÙˆØ¨Ø­Ø« (Ø§Ù„ØµÙØ­Ø© ${data.pagination?.page || 1})`);
                } else {
                    throw new Error('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù‚Ø§Ø±Ø§Øª ÙÙŠ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©');
                }
            } catch (error) {
                console.error('PropertiesScreen test failed:', error);
                document.getElementById('properties-results').innerHTML = 
                    `<div class="error">âŒ ÙØ´Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: ${error.message}</div>`;
                updateStatus('properties-status', 'error', `âŒ ÙØ´Ù„: ${error.message}`);
            }
            updateStats();
        }

        // Run tests when page loads
        window.addEventListener('load', async () => {
            console.log('ğŸš€ Starting mobile app tests...');
            
            // Run tests sequentially to avoid overwhelming the API
            await testHomeScreen();
            await new Promise(resolve => setTimeout(resolve, 1000)); // 1 second delay
            await testPropertiesScreen();
            
            console.log('âœ… Mobile app tests completed');
            console.log(`ğŸ“Š Total API calls: ${apiCalls}`);
            console.log(`ğŸ  Total properties tested: ${totalProperties}`);
            console.log(`ğŸŒŸ Virtual tours found: ${virtualToursCount}`);
        });
    </script>
</body>
</html> 