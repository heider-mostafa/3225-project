<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Areas Screen Test - Egyptian Real Estate Mobile App</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            direction: rtl;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            padding: 30px;
        }

        .test-section {
            background: #f8fafc;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            border: 2px solid #e2e8f0;
        }

        .test-section h2 {
            color: #1e293b;
            margin-bottom: 20px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .api-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .test-button {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(37, 99, 235, 0.3);
        }

        .test-button:active {
            transform: translateY(0);
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .status-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .status-card.success {
            border-color: #10b981;
            background: #f0fdf4;
        }

        .status-card.error {
            border-color: #ef4444;
            background: #fef2f2;
        }

        .status-card h3 {
            font-size: 1.1rem;
            margin-bottom: 8px;
            color: #1e293b;
        }

        .status-text {
            font-weight: 600;
            font-size: 1rem;
        }

        .status-text.success {
            color: #10b981;
        }

        .status-text.error {
            color: #ef4444;
        }

        .console {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
            line-height: 1.6;
            margin-top: 20px;
        }

        .console-line {
            margin-bottom: 5px;
            padding: 2px 0;
        }

        .console-line.success {
            color: #10b981;
        }

        .console-line.error {
            color: #ef4444;
        }

        .console-line.info {
            color: #3b82f6;
        }

        .areas-preview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .area-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
            transition: transform 0.3s ease;
        }

        .area-card:hover {
            transform: translateY(-2px);
        }

        .area-image {
            width: 100%;
            height: 200px;
            background: linear-gradient(45deg, #f3f4f6 25%, transparent 25%), 
                        linear-gradient(-45deg, #f3f4f6 25%, transparent 25%), 
                        linear-gradient(45deg, transparent 75%, #f3f4f6 75%), 
                        linear-gradient(-45deg, transparent 75%, #f3f4f6 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6b7280;
            font-size: 3rem;
        }

        .area-content {
            padding: 20px;
        }

        .area-header {
            margin-bottom: 12px;
        }

        .area-name {
            font-size: 1.25rem;
            font-weight: bold;
            color: #1e293b;
            margin-bottom: 4px;
        }

        .area-name-arabic {
            font-size: 1rem;
            color: #6b7280;
        }

        .area-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 0.875rem;
            color: #6b7280;
        }

        .area-price {
            font-size: 1.1rem;
            font-weight: bold;
            color: #059669;
            margin-bottom: 8px;
        }

        .area-features {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .feature-tag {
            background: #f1f5f9;
            color: #475569;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .filter-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }

        .filter-chip {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-chip.active {
            background: #2563eb;
            color: white;
            border-color: #2563eb;
        }

        .filter-chip:hover {
            background: #e2e8f0;
        }

        .filter-chip.active:hover {
            background: #1d4ed8;
        }

        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #2563eb;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 0.875rem;
            color: #6b7280;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèõÔ∏è ÿßÿÆÿ™ÿ®ÿßÿ± ÿ¥ÿßÿ¥ÿ© ÿßŸÑŸÖŸÜÿßÿ∑ŸÇ ÿßŸÑŸÖÿµÿ±Ÿäÿ©</h1>
            <p>ÿßÿÆÿ™ÿ®ÿßÿ± ÿ¥ÿßŸÖŸÑ ŸÑÿ¥ÿßÿ¥ÿ© ÿßŸÑŸÖŸÜÿßÿ∑ŸÇ ŸÅŸä ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™ ÿßŸÑŸÖÿµÿ±Ÿäÿ©</p>
        </div>

        <div class="main-content">
            <!-- API Status Section -->
            <div class="test-section">
                <h2>üì° ÿ≠ÿßŸÑÿ© API ŸàÿßŸÑÿßÿ™ÿµÿßŸÑ</h2>
                <div class="status-grid">
                    <div class="status-card" id="propertiesApiStatus">
                        <h3>Properties API</h3>
                        <div class="status-text" id="propertiesStatus">‚ùå Error</div>
                    </div>
                    <div class="status-card" id="areasDataStatus">
                        <h3>Areas Data Processing</h3>
                        <div class="status-text" id="areasDataText">‚ùå Error</div>
                    </div>
                    <div class="status-card" id="categoryFiltersStatus">
                        <h3>Category Filters</h3>
                        <div class="status-text" id="categoryFiltersText">‚ùå Error</div>
                    </div>
                    <div class="status-card" id="statisticsStatus">
                        <h3>Area Statistics</h3>
                        <div class="status-text" id="statisticsText">‚ùå Error</div>
                    </div>
                </div>

                <div class="api-buttons">
                    <button class="test-button" onclick="testPropertiesAPI()">
                        üè¢ Test Properties API
                    </button>
                    <button class="test-button" onclick="testAreasDataProcessing()">
                        üèòÔ∏è Test Areas Data Processing
                    </button>
                    <button class="test-button" onclick="testCategoryFilters()">
                        üîç Test Category Filters
                    </button>
                    <button class="test-button" onclick="testAreaStatistics()">
                        üìä Test Area Statistics
                    </button>
                </div>
            </div>

            <!-- Egyptian Areas Overview -->
            <div class="test-section">
                <h2>üìä ÿ•ÿ≠ÿµÿßÿ¶Ÿäÿßÿ™ ÿßŸÑŸÖŸÜÿßÿ∑ŸÇ ÿßŸÑŸÖÿµÿ±Ÿäÿ©</h2>
                <div class="stats-overview" id="statsOverview">
                    <div class="stat-card">
                        <div class="stat-value" id="totalAreasCount">-</div>
                        <div class="stat-label">ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑŸÖŸÜÿßÿ∑ŸÇ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalPropertiesCount">-</div>
                        <div class="stat-label">ÿ•ÿ¨ŸÖÿßŸÑŸä ÿßŸÑÿπŸÇÿßÿ±ÿßÿ™</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="averagePriceDisplay">-</div>
                        <div class="stat-label">ŸÖÿ™Ÿàÿ≥ÿ∑ ÿßŸÑÿ£ÿ≥ÿπÿßÿ±</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="priceGrowthDisplay">-</div>
                        <div class="stat-label">ŸÜŸÖŸà ÿßŸÑÿ£ÿ≥ÿπÿßÿ±</div>
                    </div>
                </div>
            </div>

            <!-- Category Filters Section -->
            <div class="test-section">
                <h2>üîç ÿ™ÿµŸÅŸäÿ© ÿßŸÑŸÖŸÜÿßÿ∑ŸÇ</h2>
                <div class="filter-chips" id="categoryFilters">
                    <div class="filter-chip active" data-category="all">ÿ¨ŸÖŸäÿπ ÿßŸÑŸÖŸÜÿßÿ∑ŸÇ</div>
                    <div class="filter-chip" data-category="new_developments">ÿßŸÑÿ™ÿ∑ŸàŸäÿ±ÿßÿ™ ÿßŸÑÿ¨ÿØŸäÿØÿ©</div>
                    <div class="filter-chip" data-category="luxury">ÿßŸÑŸÖŸÜÿßÿ∑ŸÇ ÿßŸÑÿ±ÿßŸÇŸäÿ©</div>
                    <div class="filter-chip" data-category="affordable">ÿßŸÑŸÖŸÜÿßÿ∑ŸÇ ÿßŸÑÿßŸÇÿ™ÿµÿßÿØŸäÿ©</div>
                    <div class="filter-chip" data-category="compounds">ÿßŸÑŸÖÿ¨ŸÖÿπÿßÿ™ ÿßŸÑÿ≥ŸÉŸÜŸäÿ©</div>
                    <div class="filter-chip" data-category="coastal">ÿßŸÑŸÖŸÜÿßÿ∑ŸÇ ÿßŸÑÿ≥ÿßÿ≠ŸÑŸäÿ©</div>
                </div>
                <div id="filteredAreasCount" style="margin-top: 10px; color: #6b7280;">
                    ÿπÿØÿØ ÿßŸÑŸÖŸÜÿßÿ∑ŸÇ ÿßŸÑŸÖÿ±ÿ¥ÿ≠ÿ©: <span id="filteredCount">0</span>
                </div>
            </div>

            <!-- Areas Preview Section -->
            <div class="test-section">
                <h2>üèòÔ∏è ŸÖÿπÿßŸäŸÜÿ© ÿßŸÑŸÖŸÜÿßÿ∑ŸÇ ÿßŸÑŸÖÿµÿ±Ÿäÿ©</h2>
                <div class="areas-preview" id="areasPreview">
                    <!-- Areas will be populated here -->
                </div>
            </div>

            <!-- Testing Console -->
            <div class="test-section">
                <h2>üìú Ÿàÿ≠ÿ© ÿßŸÑÿßÿÆÿ™ÿ®ÿßÿ±</h2>
                <div class="console" id="console">
                    <div class="console-line info">üöÄ Areas Screen Test Interface Loaded</div>
                    <div class="console-line info">üì± Ready to test Egyptian areas functionality</div>
                    <div class="console-line info"></div>
                    <div class="console-line info">Features to test:</div>
                    <div class="console-line info">‚úÖ Properties API integration</div>
                    <div class="console-line info">‚úÖ Area data processing from properties</div>
                    <div class="console-line info">‚úÖ Category filtering system</div>
                    <div class="console-line info">‚úÖ Area statistics calculation</div>
                    <div class="console-line info">‚úÖ Egyptian area information display</div>
                    <div class="console-line info">‚úÖ Transportation and amenities data</div>
                    <div class="console-line info">‚úÖ Price range and growth indicators</div>
                    <div class="console-line info">‚úÖ Arabic localization and RTL layout</div>
                    <div class="console-line info"></div>
                    <div class="console-line info">Click "Test Properties API" to start testing! üéØ</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let allProperties = [];
        let allAreas = [];
        let filteredAreas = [];
        let selectedCategory = 'all';

        // Utility functions
        const formatEGP = (price) => {
            return new Intl.NumberFormat('ar-EG', {
                style: 'currency',
                currency: 'EGP',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0,
                notation: price >= 1000000 ? 'compact' : 'standard',
            }).format(price);
        };

        const formatArabicTime = () => {
            return new Date().toLocaleString('ar-EG', {
                hour: 'numeric',
                minute: 'numeric',
                second: 'numeric',
                hour12: true
            });
        };

        const log = (message, type = 'info') => {
            const console = document.getElementById('console');
            const time = formatArabicTime();
            const line = document.createElement('div');
            line.className = `console-line ${type}`;
            line.textContent = `[${time}] ${message}`;
            console.appendChild(line);
            console.scrollTop = console.scrollHeight;
        };

        const updateStatus = (elementId, status, isSuccess) => {
            const element = document.getElementById(elementId);
            const card = element.closest('.status-card');
            
            element.textContent = status;
            element.className = `status-text ${isSuccess ? 'success' : 'error'}`;
            card.className = `status-card ${isSuccess ? 'success' : 'error'}`;
        };

        // Egyptian area information
        const getAreaInfo = (cityName) => {
            const areaInfoMap = {
                'New Cairo': {
                    arabicName: 'ÿßŸÑŸÇÿßŸáÿ±ÿ© ÿßŸÑÿ¨ÿØŸäÿØÿ©',
                    emoji: 'üèôÔ∏è',
                    description: 'ŸÖŸÜÿ∑ŸÇÿ© ÿ≠ÿØŸäÿ´ÿ© ŸÖÿÆÿ∑ÿ∑ÿ© ÿ™ÿ∂ŸÖ ÿ£ÿ±ŸÇŸâ ÿßŸÑŸÖÿ¨ŸÖÿπÿßÿ™ ÿßŸÑÿ≥ŸÉŸÜŸäÿ© ŸàÿßŸÑÿ¨ÿßŸÖÿπÿßÿ™ ÿßŸÑÿπÿßŸÑŸÖŸäÿ©',
                    amenities: ['ŸÖÿ±ÿßŸÉÿ≤ ÿ™ÿ≥ŸàŸÇ', 'ŸÖÿØÿßÿ±ÿ≥ ÿØŸàŸÑŸäÿ©', 'ŸÜŸàÿßÿØŸä ÿ±Ÿäÿßÿ∂Ÿäÿ©', 'ÿ≠ÿØÿßÿ¶ŸÇ', 'ŸÖÿ≥ÿ™ÿ¥ŸÅŸäÿßÿ™ ÿÆÿßÿµÿ©'],
                    transportation: { metro: false, airport: 45, highway: true },
                    statistics: { growth: 15, demand: 'high', pricetrend: 'up' }
                },
                'Sheikh Zayed': {
                    arabicName: 'ÿßŸÑÿ¥ŸäÿÆ ÿ≤ÿßŸäÿØ',
                    emoji: 'üåü',
                    description: 'ŸÖÿØŸäŸÜÿ© ŸÖÿ™ŸÉÿßŸÖŸÑÿ© ÿ™ÿ¨ŸÖÿπ ÿ®ŸäŸÜ ÿßŸÑÿ±ŸÇŸä ŸàÿßŸÑÿ≠ÿØÿßÿ´ÿ© ŸÖÿπ ÿ£ŸÅÿ∂ŸÑ ÿßŸÑŸÖÿ±ÿßŸÅŸÇ ŸàÿßŸÑÿÆÿØŸÖÿßÿ™',
                    amenities: ['ÿ£ŸÑŸäÿ¨ÿ±Ÿäÿß ÿ¨ŸàŸÑŸÅ', 'ÿ®ŸäŸÅÿ±ŸÑŸä ŸáŸäŸÑÿ≤', 'ŸÖŸàŸÑ ŸÖÿµÿ±', 'ÿ£ÿ±ŸÉÿßŸÜ ŸÖŸàŸÑ', 'ÿ≠ÿØÿßÿ¶ŸÇ ÿßŸÑÿ£Ÿáÿ±ÿßŸÖ'],
                    transportation: { metro: false, airport: 60, highway: true },
                    statistics: { growth: 12, demand: 'high', pricetrend: 'up' }
                },
                'Zamalek': {
                    arabicName: 'ÿßŸÑÿ≤ŸÖÿßŸÑŸÉ',
                    emoji: 'üèõÔ∏è',
                    description: 'ŸÇŸÑÿ® ÿßŸÑŸÇÿßŸáÿ±ÿ© ÿßŸÑŸÜÿßÿ®ÿ∂ÿå ÿ¨ÿ≤Ÿäÿ±ÿ© ÿßŸÑŸáÿØŸàÿ° ŸàÿßŸÑÿ´ŸÇÿßŸÅÿ© ÿπŸÑŸâ ÿ∂ŸÅÿßŸÅ ÿßŸÑŸÜŸäŸÑ',
                    amenities: ['ÿ•ÿ∑ŸÑÿßŸÑÿßÿ™ ÿßŸÑŸÜŸäŸÑ', 'ŸÜÿßÿØŸä ÿßŸÑÿ¨ÿ≤Ÿäÿ±ÿ©', 'ÿØÿßÿ± ÿßŸÑÿ£Ÿàÿ®ÿ±ÿß', 'ŸÖÿ∑ÿßÿπŸÖ ÿ±ÿßŸÇŸäÿ©', 'ŸÖŸÇÿßŸáŸä ÿ™ÿ±ÿßÿ´Ÿäÿ©'],
                    transportation: { metro: true, airport: 25, highway: false },
                    statistics: { growth: 8, demand: 'high', pricetrend: 'stable' }
                },
                'Maadi': {
                    arabicName: 'ÿßŸÑŸÖÿπÿßÿØŸä',
                    emoji: 'üå≥',
                    description: 'ÿßŸÑÿ≠Ÿä ÿßŸÑŸáÿßÿØÿ¶ ÿßŸÑŸÖŸÅÿ∂ŸÑ ŸÑŸÑÿπÿßÿ¶ŸÑÿßÿ™ ŸàÿßŸÑŸÖÿ¨ÿ™ŸÖÿπ ÿßŸÑÿØŸàŸÑŸä ŸÅŸä ÿßŸÑŸÇÿßŸáÿ±ÿ©',
                    amenities: ['ÿ¥Ÿàÿßÿ±ÿπ ŸÖÿ¥ÿ¨ÿ±ÿ©', 'ŸÖÿØÿßÿ±ÿ≥ ÿØŸàŸÑŸäÿ©', 'ŸÜÿßÿØŸä ÿßŸÑŸÖÿπÿßÿØŸä', 'ŸÉŸàÿ±ŸÜŸäÿ¥ ÿßŸÑŸÜŸäŸÑ', 'ŸÖÿ™ÿ±Ÿà ÿßŸÑÿ£ŸÜŸÅÿßŸÇ'],
                    transportation: { metro: true, airport: 35, highway: false },
                    statistics: { growth: 10, demand: 'medium', pricetrend: 'stable' }
                },
                'Heliopolis': {
                    arabicName: 'ŸÖÿµÿ± ÿßŸÑÿ¨ÿØŸäÿØÿ©',
                    emoji: 'üè∞',
                    description: 'ÿßŸÑŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑÿ™ÿßÿ±ŸäÿÆŸäÿ© ÿßŸÑÿ±ÿßŸÇŸäÿ© ŸÇÿ±Ÿäÿ®ÿßŸã ŸÖŸÜ ÿßŸÑŸÖÿ∑ÿßÿ± ŸàŸÖÿπÿßŸÑŸÖ ÿßŸÑŸÇÿßŸáÿ±ÿ©',
                    amenities: ['ŸÇÿµÿ± ÿßŸÑÿ®ÿßÿ±ŸàŸÜ', 'ŸÖÿ∑ÿßÿ± ÿßŸÑŸÇÿßŸáÿ±ÿ©', 'ŸÖÿ≥ÿ™ÿ¥ŸÅŸâ ÿßŸÑŸÖÿßÿ∏ÿ©', 'ÿ¥ÿßÿ±ÿπ ÿßŸÑÿπÿ±Ÿàÿ®ÿ©', 'ÿßŸÑŸÜÿßÿØŸä ÿßŸÑÿ£ŸáŸÑŸä'],
                    transportation: { metro: true, airport: 15, highway: true },
                    statistics: { growth: 6, demand: 'medium', pricetrend: 'stable' }
                },
                'Giza': {
                    arabicName: 'ÿßŸÑÿ¨Ÿäÿ≤ÿ©',
                    emoji: 'üè∫',
                    description: 'ŸÖŸàÿ∑ŸÜ ÿßŸÑÿ£Ÿáÿ±ÿßŸÖÿßÿ™ Ÿàÿ£ÿ®Ÿà ÿßŸÑŸáŸàŸÑÿå ŸÖŸÜÿ∑ŸÇÿ© ÿ™ÿ¨ŸÖÿπ ÿßŸÑÿ™ÿßÿ±ŸäÿÆ ŸàÿßŸÑÿ≠ÿØÿßÿ´ÿ©',
                    amenities: ['ÿ£Ÿáÿ±ÿßŸÖÿßÿ™ ÿßŸÑÿ¨Ÿäÿ≤ÿ©', 'ÿ¨ÿßŸÖÿπÿ© ÿßŸÑŸÇÿßŸáÿ±ÿ©', 'ÿ≠ÿØŸäŸÇÿ© ÿßŸÑÿ≠ŸäŸàÿßŸÜ', 'ÿßŸÑÿ£Ÿàÿ®ÿ±ÿß ÿßŸÑÿ¨ÿØŸäÿØÿ©'],
                    transportation: { metro: true, airport: 40, highway: true },
                    statistics: { growth: 5, demand: 'medium', pricetrend: 'stable' }
                },
                'Alexandria': {
                    arabicName: 'ÿßŸÑÿ•ÿ≥ŸÉŸÜÿØÿ±Ÿäÿ©',
                    emoji: 'üåä',
                    description: 'ÿπÿ±Ÿàÿ≥ ÿßŸÑÿ®ÿ≠ÿ± ÿßŸÑŸÖÿ™Ÿàÿ≥ÿ∑ÿå ÿßŸÑŸÖÿØŸäŸÜÿ© ÿßŸÑÿ≥ÿßÿ≠ŸÑŸäÿ© ÿßŸÑÿ¨ŸÖŸäŸÑÿ© ÿ®ÿ™ÿßÿ±ŸäÿÆŸáÿß ÿßŸÑÿπÿ±ŸäŸÇ',
                    amenities: ['ÿ¥Ÿàÿßÿ∑ÿ¶ ŸÖÿ™Ÿàÿ≥ÿ∑Ÿäÿ©', 'ŸÖŸÉÿ™ÿ®ÿ© ÿßŸÑÿ•ÿ≥ŸÉŸÜÿØÿ±Ÿäÿ©', 'ŸÇŸÑÿπÿ© ŸÇÿßŸäÿ™ÿ®ÿßŸä', 'ŸÉŸàÿ±ŸÜŸäÿ¥ ÿßŸÑÿ•ÿ≥ŸÉŸÜÿØÿ±Ÿäÿ©'],
                    transportation: { metro: false, airport: 50, highway: true },
                    statistics: { growth: 7, demand: 'medium', pricetrend: 'stable' }
                }
            };

            return areaInfoMap[cityName] || {
                arabicName: cityName,
                emoji: 'üèòÔ∏è',
                description: `ŸÖŸÜÿ∑ŸÇÿ© ŸÖŸÖŸäÿ≤ÿ© ŸÅŸä ${cityName}`,
                amenities: ['ŸÖÿ±ÿßŸÅŸÇ ÿ≠ÿØŸäÿ´ÿ©', 'ŸÖŸàŸÇÿπ ŸÖÿ™ŸÖŸäÿ≤'],
                transportation: { metro: false, airport: 30, highway: true },
                statistics: { growth: 5, demand: 'medium', pricetrend: 'stable' }
            };
        };

        // Test Functions
        async function testPropertiesAPI() {
            log('üîç Testing Properties API (like HomeScreen/PropertiesScreen)...');
            
            try {
                const response = await fetch('http://localhost:3000/api/properties?limit=100', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                
                // Handle the correct API response format: {properties: [...], pagination: {...}}
                if (data.properties && Array.isArray(data.properties)) {
                    allProperties = data.properties;
                    updateStatus('propertiesStatus', `‚úÖ ${data.properties.length} properties loaded`, true);
                    log(`‚úÖ Properties API: Success! Loaded ${data.properties.length} properties`);
                    log(`   API Response: properties array with ${data.properties.length} items`);
                    log(`   Pagination: ${JSON.stringify(data.pagination)}`);
                    
                    // Automatically process areas data
                    setTimeout(() => testAreasDataProcessing(), 500);
                } else {
                    throw new Error(`Invalid API response format. Expected {properties: [...]} but got: ${JSON.stringify(Object.keys(data))}`);
                }
            } catch (error) {
                updateStatus('propertiesStatus', '‚ùå API Error', false);
                log(`‚ùå Properties API Error: ${error.message}`, 'error');
            }
        }

        async function testAreasDataProcessing() {
            log('üèòÔ∏è Testing Areas Data Processing...');
            
            if (allProperties.length === 0) {
                updateStatus('areasDataText', '‚ùå No properties data', false);
                log('‚ùå Areas Data Processing Error: No properties loaded. Test Properties API first.', 'error');
                return;
            }

            try {
                // Process properties to create area data
                const areaMap = new Map();

                allProperties.forEach(property => {
                    const cityKey = property.city;
                    if (!areaMap.has(cityKey)) {
                        areaMap.set(cityKey, {
                            properties: [],
                            totalPrice: 0,
                            priceList: [],
                        });
                    }
                    
                    const areaInfo = areaMap.get(cityKey);
                    areaInfo.properties.push(property);
                    areaInfo.totalPrice += property.price;
                    areaInfo.priceList.push(property.price);
                });

                // Convert to structured area data
                allAreas = Array.from(areaMap.entries()).map(([cityName, data]) => {
                    const averagePrice = data.totalPrice / data.properties.length;
                    const sortedPrices = data.priceList.sort((a, b) => a - b);
                    const minPrice = sortedPrices[0];
                    const maxPrice = sortedPrices[sortedPrices.length - 1];

                    const areaInfo = getAreaInfo(cityName);
                    
                    return {
                        id: cityName.toLowerCase().replace(/\s+/g, '_'),
                        name: cityName,
                        arabicName: areaInfo.arabicName,
                        emoji: areaInfo.emoji,
                        properties: data.properties.length,
                        averagePrice,
                        priceRange: { min: minPrice, max: maxPrice },
                        description: areaInfo.description,
                        amenities: areaInfo.amenities,
                        transportation: areaInfo.transportation,
                        statistics: areaInfo.statistics,
                    };
                });

                allAreas.sort((a, b) => b.properties - a.properties);
                filteredAreas = [...allAreas];

                updateStatus('areasDataText', `‚úÖ ${allAreas.length} areas processed`, true);
                log(`‚úÖ Areas Data Processing: Success! Created ${allAreas.length} area profiles`);
                
                // Update UI
                updateAreasPreview();
                updateStatistics();
                
                // Automatically test statistics
                setTimeout(() => testAreaStatistics(), 500);
            } catch (error) {
                updateStatus('areasDataText', '‚ùå Processing Error', false);
                log(`‚ùå Areas Data Processing Error: ${error.message}`, 'error');
            }
        }

        async function testCategoryFilters() {
            log('üîç Testing Category Filtering...');
            
            if (allAreas.length === 0) {
                updateStatus('categoryFiltersText', '‚ùå No areas data', false);
                log('‚ùå Category Filtering Error: No areas loaded. Test Areas Data first.', 'error');
                return;
            }

            try {
                // Test all filter categories
                const categories = ['all', 'new_developments', 'luxury', 'affordable', 'compounds', 'coastal'];
                let testResults = [];

                categories.forEach(category => {
                    const filtered = filterAreasByCategory(category);
                    testResults.push(`${category}: ${filtered.length} areas`);
                });

                updateStatus('categoryFiltersText', `‚úÖ ${categories.length} filters working`, true);
                log(`‚úÖ Category Filters: Success! Tested ${categories.length} filter categories`);
                log(`   Filter results: ${testResults.join(', ')}`);
                
                // Apply current filter
                applyCurrentFilter();
            } catch (error) {
                updateStatus('categoryFiltersText', '‚ùå Filter Error', false);
                log(`‚ùå Category Filtering Error: ${error.message}`, 'error');
            }
        }

        async function testAreaStatistics() {
            log('üìä Testing Area Statistics...');
            
            if (allAreas.length === 0) {
                updateStatus('statisticsText', '‚ùå No areas data', false);
                log('‚ùå Area Statistics Error: No areas loaded. Test Areas Data first.', 'error');
                return;
            }

            try {
                const totalProperties = allProperties.length;
                const averagePrice = allProperties.reduce((sum, p) => sum + p.price, 0) / totalProperties;
                
                // Find most popular property type
                const typeCount = {};
                allProperties.forEach(p => {
                    typeCount[p.property_type] = (typeCount[p.property_type] || 0) + 1;
                });
                const mostPopularType = Object.keys(typeCount).reduce((a, b) => 
                    typeCount[a] > typeCount[b] ? a : b
                );

                const statistics = {
                    totalAreas: allAreas.length,
                    totalProperties,
                    averagePrice,
                    mostPopularType,
                    priceGrowth: 8.5
                };

                updateStatus('statisticsText', `‚úÖ Statistics calculated`, true);
                log(`‚úÖ Area Statistics: Success! Calculated comprehensive statistics`);
                log(`   Total areas: ${statistics.totalAreas}, Properties: ${statistics.totalProperties}`);
                log(`   Average price: ${formatEGP(statistics.averagePrice)}, Growth: ${statistics.priceGrowth}%`);
                
                // Update statistics display
                updateStatisticsDisplay(statistics);
            } catch (error) {
                updateStatus('statisticsText', '‚ùå Statistics Error', false);
                log(`‚ùå Area Statistics Error: ${error.message}`, 'error');
            }
        }

        // Helper functions
        function filterAreasByCategory(category) {
            let filtered = allAreas;

            switch (category) {
                case 'new_developments':
                    filtered = allAreas.filter(area => 
                        ['New Cairo', 'Sheikh Zayed'].includes(area.name)
                    );
                    break;
                case 'luxury':
                    filtered = allAreas.filter(area => 
                        area.averagePrice > 5000000
                    );
                    break;
                case 'affordable':
                    filtered = allAreas.filter(area => 
                        area.averagePrice <= 3000000
                    );
                    break;
                case 'compounds':
                    filtered = allAreas.filter(area => 
                        ['New Cairo', 'Sheikh Zayed', '6th of October'].includes(area.name)
                    );
                    break;
                case 'coastal':
                    filtered = allAreas.filter(area => 
                        ['Alexandria', 'New Alamein'].includes(area.name)
                    );
                    break;
                default:
                    filtered = allAreas;
            }

            return filtered;
        }

        function applyCurrentFilter() {
            filteredAreas = filterAreasByCategory(selectedCategory);
            updateAreasPreview();
            document.getElementById('filteredCount').textContent = filteredAreas.length;
            log(`üîç Category filter changed to: ${selectedCategory} (${filteredAreas.length} areas)`);
        }

        function updateAreasPreview() {
            const preview = document.getElementById('areasPreview');
            
            if (filteredAreas.length === 0) {
                preview.innerHTML = '<div style="text-align: center; color: #6b7280; padding: 40px;">ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖŸÜÿßÿ∑ŸÇ ŸÑÿπÿ±ÿ∂Ÿáÿß</div>';
                return;
            }

            preview.innerHTML = filteredAreas.map(area => `
                <div class="area-card">
                    <div class="area-image">${area.emoji}</div>
                    <div class="area-content">
                        <div class="area-header">
                            <div class="area-name">${area.name}</div>
                            <div class="area-name-arabic">${area.arabicName}</div>
                        </div>
                        <div class="area-stats">
                            <span>${area.properties} ÿπŸÇÿßÿ±</span>
                            <span>${area.statistics.growth}% ŸÜŸÖŸà</span>
                            <span>ÿßŸÑÿ∑ŸÑÿ®: ${area.statistics.demand === 'high' ? 'ÿπÿßŸÑŸä' : area.statistics.demand === 'medium' ? 'ŸÖÿ™Ÿàÿ≥ÿ∑' : 'ŸÖŸÜÿÆŸÅÿ∂'}</span>
                        </div>
                        <div class="area-price">
                            ŸÖÿ™Ÿàÿ≥ÿ∑ ÿßŸÑÿ≥ÿπÿ±: ${formatEGP(area.averagePrice)}
                        </div>
                        <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 12px;">
                            ${formatEGP(area.priceRange.min)} - ${formatEGP(area.priceRange.max)}
                        </div>
                        <div class="area-features">
                            ${area.amenities.slice(0, 3).map(amenity => 
                                `<span class="feature-tag">${amenity}</span>`
                            ).join('')}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function updateStatistics() {
            const totalAreas = allAreas.length;
            const totalProperties = allProperties.length;
            const averagePrice = allProperties.reduce((sum, p) => sum + p.price, 0) / totalProperties;
            
            document.getElementById('totalAreasCount').textContent = totalAreas;
            document.getElementById('totalPropertiesCount').textContent = totalProperties;
            document.getElementById('averagePriceDisplay').textContent = formatEGP(averagePrice);
            document.getElementById('priceGrowthDisplay').textContent = '8.5%';
        }

        function updateStatisticsDisplay(stats) {
            document.getElementById('totalAreasCount').textContent = stats.totalAreas;
            document.getElementById('totalPropertiesCount').textContent = stats.totalProperties;
            document.getElementById('averagePriceDisplay').textContent = formatEGP(stats.averagePrice);
            document.getElementById('priceGrowthDisplay').textContent = `${stats.priceGrowth}%`;
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Category filter chips
            document.querySelectorAll('.filter-chip').forEach(chip => {
                chip.addEventListener('click', function() {
                    // Remove active class from all chips
                    document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
                    // Add active class to clicked chip
                    this.classList.add('active');
                    // Update selected category
                    selectedCategory = this.dataset.category;
                    // Apply filter
                    applyCurrentFilter();
                });
            });
            
            // Log initial state
            log('üöÄ Areas Screen Test Interface Loaded');
            log('üì± Ready to test Egyptian areas functionality');
            log('');
            log('Features to test:');
            log('‚úÖ Properties API integration');
            log('‚úÖ Area data processing from properties');
            log('‚úÖ Category filtering system');
            log('‚úÖ Area statistics calculation');
            log('‚úÖ Egyptian area information display');
            log('‚úÖ Transportation and amenities data');
            log('‚úÖ Price range and growth indicators');
            log('‚úÖ Arabic localization and RTL layout');
            log('');
            log('Click "Test Properties API" to start testing! üéØ');
        });
    </script>
</body>
</html> 