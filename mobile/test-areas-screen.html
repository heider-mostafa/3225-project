<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Areas Screen Test - Egyptian Real Estate Mobile App</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            direction: rtl;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            padding: 30px;
        }

        .test-section {
            background: #f8fafc;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            border: 2px solid #e2e8f0;
        }

        .test-section h2 {
            color: #1e293b;
            margin-bottom: 20px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .api-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .test-button {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(37, 99, 235, 0.3);
        }

        .test-button:active {
            transform: translateY(0);
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .status-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .status-card.success {
            border-color: #10b981;
            background: #f0fdf4;
        }

        .status-card.error {
            border-color: #ef4444;
            background: #fef2f2;
        }

        .status-card h3 {
            font-size: 1.1rem;
            margin-bottom: 8px;
            color: #1e293b;
        }

        .status-text {
            font-weight: 600;
            font-size: 1rem;
        }

        .status-text.success {
            color: #10b981;
        }

        .status-text.error {
            color: #ef4444;
        }

        .console {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
            line-height: 1.6;
            margin-top: 20px;
        }

        .console-line {
            margin-bottom: 5px;
            padding: 2px 0;
        }

        .console-line.success {
            color: #10b981;
        }

        .console-line.error {
            color: #ef4444;
        }

        .console-line.info {
            color: #3b82f6;
        }

        .areas-preview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .area-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            border: 1px solid #e2e8f0;
            transition: transform 0.3s ease;
        }

        .area-card:hover {
            transform: translateY(-2px);
        }

        .area-image {
            width: 100%;
            height: 200px;
            background: linear-gradient(45deg, #f3f4f6 25%, transparent 25%), 
                        linear-gradient(-45deg, #f3f4f6 25%, transparent 25%), 
                        linear-gradient(45deg, transparent 75%, #f3f4f6 75%), 
                        linear-gradient(-45deg, transparent 75%, #f3f4f6 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6b7280;
            font-size: 3rem;
        }

        .area-content {
            padding: 20px;
        }

        .area-header {
            margin-bottom: 12px;
        }

        .area-name {
            font-size: 1.25rem;
            font-weight: bold;
            color: #1e293b;
            margin-bottom: 4px;
        }

        .area-name-arabic {
            font-size: 1rem;
            color: #6b7280;
        }

        .area-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 0.875rem;
            color: #6b7280;
        }

        .area-price {
            font-size: 1.1rem;
            font-weight: bold;
            color: #059669;
            margin-bottom: 8px;
        }

        .area-features {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .feature-tag {
            background: #f1f5f9;
            color: #475569;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .filter-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }

        .filter-chip {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-chip.active {
            background: #2563eb;
            color: white;
            border-color: #2563eb;
        }

        .filter-chip:hover {
            background: #e2e8f0;
        }

        .filter-chip.active:hover {
            background: #1d4ed8;
        }

        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #2563eb;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 0.875rem;
            color: #6b7280;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ›ï¸ Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…ØµØ±ÙŠØ©</h1>
            <p>Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„ Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª Ø§Ù„Ù…ØµØ±ÙŠØ©</p>
        </div>

        <div class="main-content">
            <!-- API Status Section -->
            <div class="test-section">
                <h2>ğŸ“¡ Ø­Ø§Ù„Ø© API ÙˆØ§Ù„Ø§ØªØµØ§Ù„</h2>
                <div class="status-grid">
                    <div class="status-card" id="propertiesApiStatus">
                        <h3>Properties API</h3>
                        <div class="status-text" id="propertiesStatus">âŒ Error</div>
                    </div>
                    <div class="status-card" id="areasDataStatus">
                        <h3>Areas Data Processing</h3>
                        <div class="status-text" id="areasDataText">âŒ Error</div>
                    </div>
                    <div class="status-card" id="categoryFiltersStatus">
                        <h3>Category Filters</h3>
                        <div class="status-text" id="categoryFiltersText">âŒ Error</div>
                    </div>
                    <div class="status-card" id="statisticsStatus">
                        <h3>Area Statistics</h3>
                        <div class="status-text" id="statisticsText">âŒ Error</div>
                    </div>
                </div>

                <div class="api-buttons">
                    <button class="test-button" onclick="testPropertiesAPI()">
                        ğŸ¢ Test Properties API
                    </button>
                    <button class="test-button" onclick="testAreasDataProcessing()">
                        ğŸ˜ï¸ Test Areas Data Processing
                    </button>
                    <button class="test-button" onclick="testCategoryFilters()">
                        ğŸ” Test Category Filters
                    </button>
                    <button class="test-button" onclick="testAreaStatistics()">
                        ğŸ“Š Test Area Statistics
                    </button>
                </div>
            </div>

            <!-- Egyptian Areas Overview -->
            <div class="test-section">
                <h2>ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…ØµØ±ÙŠØ©</h2>
                <div class="stats-overview" id="statsOverview">
                    <div class="stat-card">
                        <div class="stat-value" id="totalAreasCount">-</div>
                        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalPropertiesCount">-</div>
                        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="averagePriceDisplay">-</div>
                        <div class="stat-label">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="priceGrowthDisplay">-</div>
                        <div class="stat-label">Ù†Ù…Ùˆ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</div>
                    </div>
                </div>
            </div>

            <!-- Category Filters Section -->
            <div class="test-section">
                <h2>ğŸ” ØªØµÙÙŠØ© Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</h2>
                <div class="filter-chips" id="categoryFilters">
                    <div class="filter-chip active" data-category="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚</div>
                    <div class="filter-chip" data-category="new_developments">Ø§Ù„ØªØ·ÙˆÙŠØ±Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</div>
                    <div class="filter-chip" data-category="luxury">Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø±Ø§Ù‚ÙŠØ©</div>
                    <div class="filter-chip" data-category="affordable">Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø§Ù‚ØªØµØ§Ø¯ÙŠØ©</div>
                    <div class="filter-chip" data-category="compounds">Ø§Ù„Ù…Ø¬Ù…Ø¹Ø§Øª Ø§Ù„Ø³ÙƒÙ†ÙŠØ©</div>
                    <div class="filter-chip" data-category="coastal">Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø³Ø§Ø­Ù„ÙŠØ©</div>
                </div>
                <div id="filteredAreasCount" style="margin-top: 10px; color: #6b7280;">
                    Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…Ø±Ø´Ø­Ø©: <span id="filteredCount">0</span>
                </div>
            </div>

            <!-- Areas Preview Section -->
            <div class="test-section">
                <h2>ğŸ˜ï¸ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…ØµØ±ÙŠØ©</h2>
                <div class="areas-preview" id="areasPreview">
                    <!-- Areas will be populated here -->
                </div>
            </div>

            <!-- Testing Console -->
            <div class="test-section">
                <h2>ğŸ“œ ÙˆØ­Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h2>
                <div class="console" id="console">
                    <div class="console-line info">ğŸš€ Areas Screen Test Interface Loaded</div>
                    <div class="console-line info">ğŸ“± Ready to test Egyptian areas functionality</div>
                    <div class="console-line info"></div>
                    <div class="console-line info">Features to test:</div>
                    <div class="console-line info">âœ… Properties API integration</div>
                    <div class="console-line info">âœ… Area data processing from properties</div>
                    <div class="console-line info">âœ… Category filtering system</div>
                    <div class="console-line info">âœ… Area statistics calculation</div>
                    <div class="console-line info">âœ… Egyptian area information display</div>
                    <div class="console-line info">âœ… Transportation and amenities data</div>
                    <div class="console-line info">âœ… Price range and growth indicators</div>
                    <div class="console-line info">âœ… Arabic localization and RTL layout</div>
                    <div class="console-line info"></div>
                    <div class="console-line info">Click "Test Properties API" to start testing! ğŸ¯</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let allProperties = [];
        let allAreas = [];
        let filteredAreas = [];
        let selectedCategory = 'all';

        // Utility functions
        const formatEGP = (price) => {
            return new Intl.NumberFormat('ar-EG', {
                style: 'currency',
                currency: 'EGP',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0,
                notation: price >= 1000000 ? 'compact' : 'standard',
            }).format(price);
        };

        const formatArabicTime = () => {
            return new Date().toLocaleString('ar-EG', {
                hour: 'numeric',
                minute: 'numeric',
                second: 'numeric',
                hour12: true
            });
        };

        const log = (message, type = 'info') => {
            const console = document.getElementById('console');
            const time = formatArabicTime();
            const line = document.createElement('div');
            line.className = `console-line ${type}`;
            line.textContent = `[${time}] ${message}`;
            console.appendChild(line);
            console.scrollTop = console.scrollHeight;
        };

        const updateStatus = (elementId, status, isSuccess) => {
            const element = document.getElementById(elementId);
            const card = element.closest('.status-card');
            
            element.textContent = status;
            element.className = `status-text ${isSuccess ? 'success' : 'error'}`;
            card.className = `status-card ${isSuccess ? 'success' : 'error'}`;
        };

        // Egyptian area information
        const getAreaInfo = (cityName) => {
            const areaInfoMap = {
                'New Cairo': {
                    arabicName: 'Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©',
                    emoji: 'ğŸ™ï¸',
                    description: 'Ù…Ù†Ø·Ù‚Ø© Ø­Ø¯ÙŠØ«Ø© Ù…Ø®Ø·Ø·Ø© ØªØ¶Ù… Ø£Ø±Ù‚Ù‰ Ø§Ù„Ù…Ø¬Ù…Ø¹Ø§Øª Ø§Ù„Ø³ÙƒÙ†ÙŠØ© ÙˆØ§Ù„Ø¬Ø§Ù…Ø¹Ø§Øª Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ©',
                    amenities: ['Ù…Ø±Ø§ÙƒØ² ØªØ³ÙˆÙ‚', 'Ù…Ø¯Ø§Ø±Ø³ Ø¯ÙˆÙ„ÙŠØ©', 'Ù†ÙˆØ§Ø¯ÙŠ Ø±ÙŠØ§Ø¶ÙŠØ©', 'Ø­Ø¯Ø§Ø¦Ù‚', 'Ù…Ø³ØªØ´ÙÙŠØ§Øª Ø®Ø§ØµØ©'],
                    transportation: { metro: false, airport: 45, highway: true },
                    statistics: { growth: 15, demand: 'high', pricetrend: 'up' }
                },
                'Sheikh Zayed': {
                    arabicName: 'Ø§Ù„Ø´ÙŠØ® Ø²Ø§ÙŠØ¯',
                    emoji: 'ğŸŒŸ',
                    description: 'Ù…Ø¯ÙŠÙ†Ø© Ù…ØªÙƒØ§Ù…Ù„Ø© ØªØ¬Ù…Ø¹ Ø¨ÙŠÙ† Ø§Ù„Ø±Ù‚ÙŠ ÙˆØ§Ù„Ø­Ø¯Ø§Ø«Ø© Ù…Ø¹ Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ø±Ø§ÙÙ‚ ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª',
                    amenities: ['Ø£Ù„ÙŠØ¬Ø±ÙŠØ§ Ø¬ÙˆÙ„Ù', 'Ø¨ÙŠÙØ±Ù„ÙŠ Ù‡ÙŠÙ„Ø²', 'Ù…ÙˆÙ„ Ù…ØµØ±', 'Ø£Ø±ÙƒØ§Ù† Ù…ÙˆÙ„', 'Ø­Ø¯Ø§Ø¦Ù‚ Ø§Ù„Ø£Ù‡Ø±Ø§Ù…'],
                    transportation: { metro: false, airport: 60, highway: true },
                    statistics: { growth: 12, demand: 'high', pricetrend: 'up' }
                },
                'Zamalek': {
                    arabicName: 'Ø§Ù„Ø²Ù…Ø§Ù„Ùƒ',
                    emoji: 'ğŸ›ï¸',
                    description: 'Ù‚Ù„Ø¨ Ø§Ù„Ù‚Ø§Ù‡Ø±Ø© Ø§Ù„Ù†Ø§Ø¨Ø¶ØŒ Ø¬Ø²ÙŠØ±Ø© Ø§Ù„Ù‡Ø¯ÙˆØ¡ ÙˆØ§Ù„Ø«Ù‚Ø§ÙØ© Ø¹Ù„Ù‰ Ø¶ÙØ§Ù Ø§Ù„Ù†ÙŠÙ„',
                    amenities: ['Ø¥Ø·Ù„Ø§Ù„Ø§Øª Ø§Ù„Ù†ÙŠÙ„', 'Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø¬Ø²ÙŠØ±Ø©', 'Ø¯Ø§Ø± Ø§Ù„Ø£ÙˆØ¨Ø±Ø§', 'Ù…Ø·Ø§Ø¹Ù… Ø±Ø§Ù‚ÙŠØ©', 'Ù…Ù‚Ø§Ù‡ÙŠ ØªØ±Ø§Ø«ÙŠØ©'],
                    transportation: { metro: true, airport: 25, highway: false },
                    statistics: { growth: 8, demand: 'high', pricetrend: 'stable' }
                },
                'Maadi': {
                    arabicName: 'Ø§Ù„Ù…Ø¹Ø§Ø¯ÙŠ',
                    emoji: 'ğŸŒ³',
                    description: 'Ø§Ù„Ø­ÙŠ Ø§Ù„Ù‡Ø§Ø¯Ø¦ Ø§Ù„Ù…ÙØ¶Ù„ Ù„Ù„Ø¹Ø§Ø¦Ù„Ø§Øª ÙˆØ§Ù„Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ø¯ÙˆÙ„ÙŠ ÙÙŠ Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©',
                    amenities: ['Ø´ÙˆØ§Ø±Ø¹ Ù…Ø´Ø¬Ø±Ø©', 'Ù…Ø¯Ø§Ø±Ø³ Ø¯ÙˆÙ„ÙŠØ©', 'Ù†Ø§Ø¯ÙŠ Ø§Ù„Ù…Ø¹Ø§Ø¯ÙŠ', 'ÙƒÙˆØ±Ù†ÙŠØ´ Ø§Ù„Ù†ÙŠÙ„', 'Ù…ØªØ±Ùˆ Ø§Ù„Ø£Ù†ÙØ§Ù‚'],
                    transportation: { metro: true, airport: 35, highway: false },
                    statistics: { growth: 10, demand: 'medium', pricetrend: 'stable' }
                },
                'Heliopolis': {
                    arabicName: 'Ù…ØµØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©',
                    emoji: 'ğŸ°',
                    description: 'Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠØ© Ø§Ù„Ø±Ø§Ù‚ÙŠØ© Ù‚Ø±ÙŠØ¨Ø§Ù‹ Ù…Ù† Ø§Ù„Ù…Ø·Ø§Ø± ÙˆÙ…Ø¹Ø§Ù„Ù… Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©',
                    amenities: ['Ù‚ØµØ± Ø§Ù„Ø¨Ø§Ø±ÙˆÙ†', 'Ù…Ø·Ø§Ø± Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©', 'Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ù…Ø§Ø¸Ø©', 'Ø´Ø§Ø±Ø¹ Ø§Ù„Ø¹Ø±ÙˆØ¨Ø©', 'Ø§Ù„Ù†Ø§Ø¯ÙŠ Ø§Ù„Ø£Ù‡Ù„ÙŠ'],
                    transportation: { metro: true, airport: 15, highway: true },
                    statistics: { growth: 6, demand: 'medium', pricetrend: 'stable' }
                },
                'Giza': {
                    arabicName: 'Ø§Ù„Ø¬ÙŠØ²Ø©',
                    emoji: 'ğŸº',
                    description: 'Ù…ÙˆØ·Ù† Ø§Ù„Ø£Ù‡Ø±Ø§Ù…Ø§Øª ÙˆØ£Ø¨Ùˆ Ø§Ù„Ù‡ÙˆÙ„ØŒ Ù…Ù†Ø·Ù‚Ø© ØªØ¬Ù…Ø¹ Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„Ø­Ø¯Ø§Ø«Ø©',
                    amenities: ['Ø£Ù‡Ø±Ø§Ù…Ø§Øª Ø§Ù„Ø¬ÙŠØ²Ø©', 'Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©', 'Ø­Ø¯ÙŠÙ‚Ø© Ø§Ù„Ø­ÙŠÙˆØ§Ù†', 'Ø§Ù„Ø£ÙˆØ¨Ø±Ø§ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©'],
                    transportation: { metro: true, airport: 40, highway: true },
                    statistics: { growth: 5, demand: 'medium', pricetrend: 'stable' }
                },
                'Alexandria': {
                    arabicName: 'Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©',
                    emoji: 'ğŸŒŠ',
                    description: 'Ø¹Ø±ÙˆØ³ Ø§Ù„Ø¨Ø­Ø± Ø§Ù„Ù…ØªÙˆØ³Ø·ØŒ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ø³Ø§Ø­Ù„ÙŠØ© Ø§Ù„Ø¬Ù…ÙŠÙ„Ø© Ø¨ØªØ§Ø±ÙŠØ®Ù‡Ø§ Ø§Ù„Ø¹Ø±ÙŠÙ‚',
                    amenities: ['Ø´ÙˆØ§Ø·Ø¦ Ù…ØªÙˆØ³Ø·ÙŠØ©', 'Ù…ÙƒØªØ¨Ø© Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©', 'Ù‚Ù„Ø¹Ø© Ù‚Ø§ÙŠØªØ¨Ø§ÙŠ', 'ÙƒÙˆØ±Ù†ÙŠØ´ Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©'],
                    transportation: { metro: false, airport: 50, highway: true },
                    statistics: { growth: 7, demand: 'medium', pricetrend: 'stable' }
                }
            };

            return areaInfoMap[cityName] || {
                arabicName: cityName,
                emoji: 'ğŸ˜ï¸',
                description: `Ù…Ù†Ø·Ù‚Ø© Ù…Ù…ÙŠØ²Ø© ÙÙŠ ${cityName}`,
                amenities: ['Ù…Ø±Ø§ÙÙ‚ Ø­Ø¯ÙŠØ«Ø©', 'Ù…ÙˆÙ‚Ø¹ Ù…ØªÙ…ÙŠØ²'],
                transportation: { metro: false, airport: 30, highway: true },
                statistics: { growth: 5, demand: 'medium', pricetrend: 'stable' }
            };
        };

        // Test Functions
        async function testPropertiesAPI() {
            log('ğŸ” Testing Properties API (like HomeScreen/PropertiesScreen)...');
            
            try {
                const response = await fetch('http://localhost:3000/api/properties?limit=100', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                
                // Handle the correct API response format: {properties: [...], pagination: {...}}
                if (data.properties && Array.isArray(data.properties)) {
                    allProperties = data.properties;
                    updateStatus('propertiesStatus', `âœ… ${data.properties.length} properties loaded`, true);
                    log(`âœ… Properties API: Success! Loaded ${data.properties.length} properties`);
                    log(`   API Response: properties array with ${data.properties.length} items`);
                    log(`   Pagination: ${JSON.stringify(data.pagination)}`);
                    
                    // Automatically process areas data
                    setTimeout(() => testAreasDataProcessing(), 500);
                } else {
                    throw new Error(`Invalid API response format. Expected {properties: [...]} but got: ${JSON.stringify(Object.keys(data))}`);
                }
            } catch (error) {
                updateStatus('propertiesStatus', 'âŒ API Error', false);
                log(`âŒ Properties API Error: ${error.message}`, 'error');
            }
        }

        async function testAreasDataProcessing() {
            log('ğŸ˜ï¸ Testing Areas Data Processing...');
            
            if (allProperties.length === 0) {
                updateStatus('areasDataText', 'âŒ No properties data', false);
                log('âŒ Areas Data Processing Error: No properties loaded. Test Properties API first.', 'error');
                return;
            }

            try {
                // Process properties to create area data
                const areaMap = new Map();

                allProperties.forEach(property => {
                    const cityKey = property.city;
                    if (!areaMap.has(cityKey)) {
                        areaMap.set(cityKey, {
                            properties: [],
                            totalPrice: 0,
                            priceList: [],
                        });
                    }
                    
                    const areaInfo = areaMap.get(cityKey);
                    areaInfo.properties.push(property);
                    areaInfo.totalPrice += property.price;
                    areaInfo.priceList.push(property.price);
                });

                // Convert to structured area data
                allAreas = Array.from(areaMap.entries()).map(([cityName, data]) => {
                    const averagePrice = data.totalPrice / data.properties.length;
                    const sortedPrices = data.priceList.sort((a, b) => a - b);
                    const minPrice = sortedPrices[0];
                    const maxPrice = sortedPrices[sortedPrices.length - 1];

                    const areaInfo = getAreaInfo(cityName);
                    
                    return {
                        id: cityName.toLowerCase().replace(/\s+/g, '_'),
                        name: cityName,
                        arabicName: areaInfo.arabicName,
                        emoji: areaInfo.emoji,
                        properties: data.properties.length,
                        averagePrice,
                        priceRange: { min: minPrice, max: maxPrice },
                        description: areaInfo.description,
                        amenities: areaInfo.amenities,
                        transportation: areaInfo.transportation,
                        statistics: areaInfo.statistics,
                    };
                });

                allAreas.sort((a, b) => b.properties - a.properties);
                filteredAreas = [...allAreas];

                updateStatus('areasDataText', `âœ… ${allAreas.length} areas processed`, true);
                log(`âœ… Areas Data Processing: Success! Created ${allAreas.length} area profiles`);
                
                // Update UI
                updateAreasPreview();
                updateStatistics();
                
                // Automatically test statistics
                setTimeout(() => testAreaStatistics(), 500);
            } catch (error) {
                updateStatus('areasDataText', 'âŒ Processing Error', false);
                log(`âŒ Areas Data Processing Error: ${error.message}`, 'error');
            }
        }

        async function testCategoryFilters() {
            log('ğŸ” Testing Category Filtering...');
            
            if (allAreas.length === 0) {
                updateStatus('categoryFiltersText', 'âŒ No areas data', false);
                log('âŒ Category Filtering Error: No areas loaded. Test Areas Data first.', 'error');
                return;
            }

            try {
                // Test all filter categories
                const categories = ['all', 'new_developments', 'luxury', 'affordable', 'compounds', 'coastal'];
                let testResults = [];

                categories.forEach(category => {
                    const filtered = filterAreasByCategory(category);
                    testResults.push(`${category}: ${filtered.length} areas`);
                });

                updateStatus('categoryFiltersText', `âœ… ${categories.length} filters working`, true);
                log(`âœ… Category Filters: Success! Tested ${categories.length} filter categories`);
                log(`   Filter results: ${testResults.join(', ')}`);
                
                // Apply current filter
                applyCurrentFilter();
            } catch (error) {
                updateStatus('categoryFiltersText', 'âŒ Filter Error', false);
                log(`âŒ Category Filtering Error: ${error.message}`, 'error');
            }
        }

        async function testAreaStatistics() {
            log('ğŸ“Š Testing Area Statistics...');
            
            if (allAreas.length === 0) {
                updateStatus('statisticsText', 'âŒ No areas data', false);
                log('âŒ Area Statistics Error: No areas loaded. Test Areas Data first.', 'error');
                return;
            }

            try {
                const totalProperties = allProperties.length;
                const averagePrice = allProperties.reduce((sum, p) => sum + p.price, 0) / totalProperties;
                
                // Find most popular property type
                const typeCount = {};
                allProperties.forEach(p => {
                    typeCount[p.property_type] = (typeCount[p.property_type] || 0) + 1;
                });
                const mostPopularType = Object.keys(typeCount).reduce((a, b) => 
                    typeCount[a] > typeCount[b] ? a : b
                );

                const statistics = {
                    totalAreas: allAreas.length,
                    totalProperties,
                    averagePrice,
                    mostPopularType,
                    priceGrowth: 8.5
                };

                updateStatus('statisticsText', `âœ… Statistics calculated`, true);
                log(`âœ… Area Statistics: Success! Calculated comprehensive statistics`);
                log(`   Total areas: ${statistics.totalAreas}, Properties: ${statistics.totalProperties}`);
                log(`   Average price: ${formatEGP(statistics.averagePrice)}, Growth: ${statistics.priceGrowth}%`);
                
                // Update statistics display
                updateStatisticsDisplay(statistics);
            } catch (error) {
                updateStatus('statisticsText', 'âŒ Statistics Error', false);
                log(`âŒ Area Statistics Error: ${error.message}`, 'error');
            }
        }

        // Helper functions
        function filterAreasByCategory(category) {
            let filtered = allAreas;

            switch (category) {
                case 'new_developments':
                    filtered = allAreas.filter(area => 
                        ['New Cairo', 'Sheikh Zayed'].includes(area.name)
                    );
                    break;
                case 'luxury':
                    filtered = allAreas.filter(area => 
                        area.averagePrice > 5000000
                    );
                    break;
                case 'affordable':
                    filtered = allAreas.filter(area => 
                        area.averagePrice <= 3000000
                    );
                    break;
                case 'compounds':
                    filtered = allAreas.filter(area => 
                        ['New Cairo', 'Sheikh Zayed', '6th of October'].includes(area.name)
                    );
                    break;
                case 'coastal':
                    filtered = allAreas.filter(area => 
                        ['Alexandria', 'New Alamein'].includes(area.name)
                    );
                    break;
                default:
                    filtered = allAreas;
            }

            return filtered;
        }

        function applyCurrentFilter() {
            filteredAreas = filterAreasByCategory(selectedCategory);
            updateAreasPreview();
            document.getElementById('filteredCount').textContent = filteredAreas.length;
            log(`ğŸ” Category filter changed to: ${selectedCategory} (${filteredAreas.length} areas)`);
        }

        function updateAreasPreview() {
            const preview = document.getElementById('areasPreview');
            
            if (filteredAreas.length === 0) {
                preview.innerHTML = '<div style="text-align: center; color: #6b7280; padding: 40px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†Ø§Ø·Ù‚ Ù„Ø¹Ø±Ø¶Ù‡Ø§</div>';
                return;
            }

            preview.innerHTML = filteredAreas.map(area => `
                <div class="area-card">
                    <div class="area-image">${area.emoji}</div>
                    <div class="area-content">
                        <div class="area-header">
                            <div class="area-name">${area.name}</div>
                            <div class="area-name-arabic">${area.arabicName}</div>
                        </div>
                        <div class="area-stats">
                            <span>${area.properties} Ø¹Ù‚Ø§Ø±</span>
                            <span>${area.statistics.growth}% Ù†Ù…Ùˆ</span>
                            <span>Ø§Ù„Ø·Ù„Ø¨: ${area.statistics.demand === 'high' ? 'Ø¹Ø§Ù„ÙŠ' : area.statistics.demand === 'medium' ? 'Ù…ØªÙˆØ³Ø·' : 'Ù…Ù†Ø®ÙØ¶'}</span>
                        </div>
                        <div class="area-price">
                            Ù…ØªÙˆØ³Ø· Ø§Ù„Ø³Ø¹Ø±: ${formatEGP(area.averagePrice)}
                        </div>
                        <div style="font-size: 0.875rem; color: #6b7280; margin-bottom: 12px;">
                            ${formatEGP(area.priceRange.min)} - ${formatEGP(area.priceRange.max)}
                        </div>
                        <div class="area-features">
                            ${area.amenities.slice(0, 3).map(amenity => 
                                `<span class="feature-tag">${amenity}</span>`
                            ).join('')}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function updateStatistics() {
            const totalAreas = allAreas.length;
            const totalProperties = allProperties.length;
            const averagePrice = allProperties.reduce((sum, p) => sum + p.price, 0) / totalProperties;
            
            document.getElementById('totalAreasCount').textContent = totalAreas;
            document.getElementById('totalPropertiesCount').textContent = totalProperties;
            document.getElementById('averagePriceDisplay').textContent = formatEGP(averagePrice);
            document.getElementById('priceGrowthDisplay').textContent = '8.5%';
        }

        function updateStatisticsDisplay(stats) {
            document.getElementById('totalAreasCount').textContent = stats.totalAreas;
            document.getElementById('totalPropertiesCount').textContent = stats.totalProperties;
            document.getElementById('averagePriceDisplay').textContent = formatEGP(stats.averagePrice);
            document.getElementById('priceGrowthDisplay').textContent = `${stats.priceGrowth}%`;
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Category filter chips
            document.querySelectorAll('.filter-chip').forEach(chip => {
                chip.addEventListener('click', function() {
                    // Remove active class from all chips
                    document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
                    // Add active class to clicked chip
                    this.classList.add('active');
                    // Update selected category
                    selectedCategory = this.dataset.category;
                    // Apply filter
                    applyCurrentFilter();
                });
            });
            
            // Log initial state
            log('ğŸš€ Areas Screen Test Interface Loaded');
            log('ğŸ“± Ready to test Egyptian areas functionality');
            log('');
            log('Features to test:');
            log('âœ… Properties API integration');
            log('âœ… Area data processing from properties');
            log('âœ… Category filtering system');
            log('âœ… Area statistics calculation');
            log('âœ… Egyptian area information display');
            log('âœ… Transportation and amenities data');
            log('âœ… Price range and growth indicators');
            log('âœ… Arabic localization and RTL layout');
            log('');
            log('Click "Test Properties API" to start testing! ğŸ¯');
        });
    </script>
</body>
</html> 